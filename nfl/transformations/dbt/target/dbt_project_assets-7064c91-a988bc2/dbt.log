{"data": {"log_version": 3, "version": "=1.8.7"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "Running with dbt=1.8.7", "name": "MainReportVersion", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:58.963684Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt build --select nfl.flex_stats", "log_cache_events": "False", "log_format": "json", "log_path": "/home/christianocean/mta/nfl/transformations/dbt/target/dbt_project_assets-7064c91-a988bc2", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/home/christianocean/mta/nfl/transformations/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "target/dbt_project_assets-7064c91-a988bc2", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/christianocean/mta/nfl/transformations/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/christianocean/mta/nfl/transformations/dbt/target/dbt_project_assets-7064c91-a988bc2', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'static_parser': 'True', 'invocation_command': 'dbt build --select nfl.flex_stats', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'target/dbt_project_assets-7064c91-a988bc2', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:58.965815Z"}}
{"data": {"adapter_name": "duckdb", "adapter_version": "=1.8.3"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "Registered adapter: duckdb=1.8.3", "name": "AdapterRegistered", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.180957Z"}}
{"data": {"checksum": "4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0", "profile": "", "target": "", "vars": "{}", "version": "1.8.7"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7", "name": "StateCheckVarsHash", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.188464Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.279128Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.279890Z"}}
{"data": {"stat_line": "9 models, 5 data tests, 1 source, 416 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "Found 9 models, 5 data tests, 1 source, 416 macros", "name": "FoundStats", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.415215Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "", "name": "Formatting", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.416798Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Acquiring new duckdb connection 'master'", "name": "NewConnection", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.417436Z"}}
{"data": {"conn_name": "list_nfl_database", "conn_type": "duckdb"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Acquiring new duckdb connection 'list_nfl_database'", "name": "NewConnection", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.418564Z"}}
{"data": {"conn_name": "list_nfl_database", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Using duckdb connection \"list_nfl_database\"", "name": "ConnectionUsed", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.445938Z"}}
{"data": {"conn_name": "list_nfl_database", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"default\", \"target_name\": \"dev\", \"connection_name\": \"list_nfl_database\"} */\n\n    \n    select schema_name\n    from system.information_schema.schemata\n    \n    where catalog_name = '\"nfl_database\"'\n    \n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On list_nfl_database: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"default\", \"target_name\": \"dev\", \"connection_name\": \"list_nfl_database\"} */\n\n    \n    select schema_name\n    from system.information_schema.schemata\n    \n    where catalog_name = '\"nfl_database\"'\n    \n  \n  ", "name": "SQLQuery", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.446432Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.446758Z"}}
{"data": {"elapsed": 0.013712024, "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "SQL status: OK in 0.014 seconds", "name": "SQLQueryStatus", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.460594Z"}}
{"data": {"conn_name": "list_nfl_database"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On list_nfl_database: Close", "name": "ConnectionClosed", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.461795Z"}}
{"data": {"conn_name": "create_nfl_database_main", "orig_conn_name": "list_nfl_database"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_nfl_database, now create_nfl_database_main)", "name": "ConnectionReused", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.464432Z"}}
{"data": {"relation": {"database": "nfl_database", "identifier": "", "schema": "main"}}, "info": {"category": "", "code": "E020", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Creating schema \"database: \"nfl_database\"\nschema: \"main\"\n\"", "name": "SchemaCreation", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.464958Z"}}
{"data": {"conn_name": "create_nfl_database_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Using duckdb connection \"create_nfl_database_main\"", "name": "ConnectionUsed", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.471043Z"}}
{"data": {"conn_name": "create_nfl_database_main", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"default\", \"target_name\": \"dev\", \"connection_name\": \"create_nfl_database_main\"} */\n\n    \n        select type from duckdb_databases()\n        where database_name='nfl_database'\n        and type='sqlite'\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On create_nfl_database_main: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"default\", \"target_name\": \"dev\", \"connection_name\": \"create_nfl_database_main\"} */\n\n    \n        select type from duckdb_databases()\n        where database_name='nfl_database'\n        and type='sqlite'\n    \n  ", "name": "SQLQuery", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.471546Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.471870Z"}}
{"data": {"elapsed": 0.008318579, "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "SQL status: OK in 0.008 seconds", "name": "SQLQueryStatus", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.480281Z"}}
{"data": {"conn_name": "create_nfl_database_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Using duckdb connection \"create_nfl_database_main\"", "name": "ConnectionUsed", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.481582Z"}}
{"data": {"conn_name": "create_nfl_database_main", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On create_nfl_database_main: BEGIN", "name": "SQLQuery", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.481989Z"}}
{"data": {"elapsed": 0.000981559, "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "SQL status: OK in 0.001 seconds", "name": "SQLQueryStatus", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.483372Z"}}
{"data": {"conn_name": "create_nfl_database_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Using duckdb connection \"create_nfl_database_main\"", "name": "ConnectionUsed", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.483975Z"}}
{"data": {"conn_name": "create_nfl_database_main", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"default\", \"target_name\": \"dev\", \"connection_name\": \"create_nfl_database_main\"} */\n\n    \n    \n        create schema if not exists \"nfl_database\".\"main\"\n    "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On create_nfl_database_main: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"default\", \"target_name\": \"dev\", \"connection_name\": \"create_nfl_database_main\"} */\n\n    \n    \n        create schema if not exists \"nfl_database\".\"main\"\n    ", "name": "SQLQuery", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.484309Z"}}
{"data": {"elapsed": 0.001086944, "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "SQL status: OK in 0.001 seconds", "name": "SQLQueryStatus", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.485795Z"}}
{"data": {"conn_name": "create_nfl_database_main"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On create_nfl_database_main: COMMIT", "name": "SQLCommit", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.486765Z"}}
{"data": {"conn_name": "create_nfl_database_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Using duckdb connection \"create_nfl_database_main\"", "name": "ConnectionUsed", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.487122Z"}}
{"data": {"conn_name": "create_nfl_database_main", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On create_nfl_database_main: COMMIT", "name": "SQLQuery", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.487421Z"}}
{"data": {"elapsed": 0.000240578, "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.487975Z"}}
{"data": {"conn_name": "create_nfl_database_main"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On create_nfl_database_main: Close", "name": "ConnectionClosed", "pid": 2079383, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-10-01T15:16:59.488360Z"}}
{"data": {"conn_name": "list_nfl_database_main", "orig_conn_name": "create_nfl_database_main"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Re-using an available connection from the pool (formerly create_nfl_database_main, now list_nfl_database_main)", "name": "ConnectionReused", "pid": 2079383, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-01T15:16:59.494813Z"}}
{"data": {"conn_name": "list_nfl_database_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Using duckdb connection \"list_nfl_database_main\"", "name": "ConnectionUsed", "pid": 2079383, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-01T15:16:59.499055Z"}}
{"data": {"conn_name": "list_nfl_database_main", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On list_nfl_database_main: BEGIN", "name": "SQLQuery", "pid": 2079383, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-01T15:16:59.499570Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 2079383, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-01T15:16:59.499926Z"}}
{"data": {"elapsed": 0.008406123, "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "SQL status: OK in 0.008 seconds", "name": "SQLQueryStatus", "pid": 2079383, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-01T15:16:59.508418Z"}}
{"data": {"conn_name": "list_nfl_database_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Using duckdb connection \"list_nfl_database_main\"", "name": "ConnectionUsed", "pid": 2079383, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-01T15:16:59.508952Z"}}
{"data": {"conn_name": "list_nfl_database_main", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"default\", \"target_name\": \"dev\", \"connection_name\": \"list_nfl_database_main\"} */\nselect\n      'nfl_database' as database,\n      table_name as name,\n      table_schema as schema,\n      CASE table_type\n        WHEN 'BASE TABLE' THEN 'table'\n        WHEN 'VIEW' THEN 'view'\n        WHEN 'LOCAL TEMPORARY' THEN 'table'\n        END as type\n    from system.information_schema.tables\n    where table_schema = 'main'\n    and table_catalog = 'nfl_database'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On list_nfl_database_main: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"default\", \"target_name\": \"dev\", \"connection_name\": \"list_nfl_database_main\"} */\nselect\n      'nfl_database' as database,\n      table_name as name,\n      table_schema as schema,\n      CASE table_type\n        WHEN 'BASE TABLE' THEN 'table'\n        WHEN 'VIEW' THEN 'view'\n        WHEN 'LOCAL TEMPORARY' THEN 'table'\n        END as type\n    from system.information_schema.tables\n    where table_schema = 'main'\n    and table_catalog = 'nfl_database'\n  ", "name": "SQLQuery", "pid": 2079383, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-01T15:16:59.509336Z"}}
{"data": {"elapsed": 0.015319684, "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "SQL status: OK in 0.015 seconds", "name": "SQLQueryStatus", "pid": 2079383, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-01T15:16:59.525136Z"}}
{"data": {"conn_name": "list_nfl_database_main"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On list_nfl_database_main: ROLLBACK", "name": "Rollback", "pid": 2079383, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-01T15:16:59.529364Z"}}
{"data": {"conn_name": "list_nfl_database_main", "exc_info": "Traceback (most recent call last):\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/base/connections.py\", line 328, in _rollback_handle\n    connection.handle.rollback()\nAttributeError: 'DuckDBConnectionWrapper' object has no attribute 'rollback'\n"}, "info": {"category": "", "code": "E009", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Failed to rollback 'list_nfl_database_main'", "name": "RollbackFailed", "pid": 2079383, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-01T15:16:59.530045Z"}}
{"data": {"conn_name": "list_nfl_database_main"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On list_nfl_database_main: Close", "name": "ConnectionClosed", "pid": 2079383, "thread": "ThreadPoolExecutor-1_0", "ts": "2024-10-01T15:16:59.530501Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Using duckdb connection \"master\"", "name": "ConnectionUsed", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.534620Z"}}
{"data": {"conn_name": "master", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On master: BEGIN", "name": "SQLQuery", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.535113Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.535453Z"}}
{"data": {"elapsed": 0.007923966, "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "SQL status: OK in 0.008 seconds", "name": "SQLQueryStatus", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.543449Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.543929Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Using duckdb connection \"master\"", "name": "ConnectionUsed", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.544234Z"}}
{"data": {"conn_name": "master", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On master: COMMIT", "name": "SQLQuery", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.544505Z"}}
{"data": {"elapsed": 0.00014215299, "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.544952Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.545336Z"}}
{"data": {"node_count": 1, "num_threads": 16, "target_name": "dev"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "Concurrency: 16 threads (target='dev')", "name": "ConcurrencyLine", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.546886Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "", "name": "Formatting", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.547263Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "started", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Began running node model.nfl.flex_stats", "name": "NodeStart", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.553809Z"}}
{"data": {"description": "sql table model main.flex_stats", "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "started", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "1 of 1 START sql table model main.flex_stats ................................... [RUN]", "name": "LogStartLine", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.554554Z"}}
{"data": {"conn_name": "model.nfl.flex_stats", "conn_type": "duckdb", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "started", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Acquiring new duckdb connection 'model.nfl.flex_stats'", "name": "NewConnection", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.555238Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Began compiling node model.nfl.flex_stats", "name": "NodeCompiling", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.555707Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Writing injected SQL for node \"model.nfl.flex_stats\"", "name": "WritingInjectedSQLForNode", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.565080Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Began executing node model.nfl.flex_stats", "name": "NodeExecuting", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.566414Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nfl.flex_stats\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Writing runtime sql for node \"model.nfl.flex_stats\"", "name": "JinjaLogDebug", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.638217Z"}}
{"data": {"conn_name": "model.nfl.flex_stats", "conn_type": "duckdb", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Using duckdb connection \"model.nfl.flex_stats\"", "name": "ConnectionUsed", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.639377Z"}}
{"data": {"conn_name": "model.nfl.flex_stats", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}, "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On model.nfl.flex_stats: BEGIN", "name": "SQLQuery", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.639846Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.640199Z"}}
{"data": {"elapsed": 0.008157396, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}, "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "SQL status: OK in 0.008 seconds", "name": "SQLQueryStatus", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.648437Z"}}
{"data": {"conn_name": "model.nfl.flex_stats", "conn_type": "duckdb", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Using duckdb connection \"model.nfl.flex_stats\"", "name": "ConnectionUsed", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.649002Z"}}
{"data": {"conn_name": "model.nfl.flex_stats", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"default\", \"target_name\": \"dev\", \"node_id\": \"model.nfl.flex_stats\"} */\n\n  \n    \n    \n\n    create  table\n      \"nfl_database\".\"main\".\"flex_stats__dbt_tmp\"\n  \n    as (\n      WITH rushing_stats AS (\n    SELECT\n        posteam AS Team,\n        rusher_player_name AS Player_Name,\n        rusher_position AS Position,\n        \n        COUNT(*) AS Total_Rush_Attempts,\n        ROUND(SUM(yards_gained), 2) AS Total_Rushing_Yards,\n        ROUND(SUM(CASE WHEN yards_gained >= 10 THEN 1 ELSE 0 END), 2) AS Explosive_Rushes,\n        ROUND(SUM(CASE WHEN first_down_rush = 1 THEN 1 ELSE 0 END), 2) AS Total_First_Downs_Rush,\n        ROUND(SUM(CASE WHEN touchdown = 1 THEN 1 ELSE 0 END), 2) AS Rushing_Touchdowns,\n        ROUND(SUM(CASE WHEN third_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Third_Down_Conversions_Rush,\n        ROUND(SUM(CASE WHEN fourth_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Fourth_Down_Conversions_Rush,\n        ROUND(SUM(epa), 2) AS Total_Rushing_EPA\n    FROM pbp\n    WHERE play_type = 'run'\n    AND rusher_position IN ('RB', 'WR', 'TE')\n    GROUP BY posteam, rusher_player_name, rusher_position\n),\nreceiving_stats AS (\n    SELECT\n        posteam AS Team,\n        receiver_display_name AS Player_Name,\n        receiver_position AS Position,\n        \n        COUNT(*) AS Total_Pass_Targets,\n        ROUND(SUM(CASE WHEN complete_pass = 1 THEN 1 ELSE 0 END), 2) AS Total_Catches,\n        ROUND(SUM(yards_gained), 2) AS Total_Receiving_Yards,\n        ROUND(SUM(air_yards), 2) AS Total_Air_Yards,\n        ROUND(SUM(yards_after_catch), 2) AS Total_YAC,\n        ROUND(SUM(CASE WHEN first_down_pass = 1 THEN 1 ELSE 0 END), 2) AS Total_First_Downs_Pass,\n        ROUND(SUM(CASE WHEN touchdown = 1 THEN 1 ELSE 0 END), 2) AS Receiving_Touchdowns,\n        ROUND(SUM(CASE WHEN third_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Third_Down_Conversions_Pass,\n        ROUND(SUM(CASE WHEN fourth_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Fourth_Down_Conversions_Pass,\n        ROUND(SUM(epa), 2) AS Total_Receiving_EPA\n    FROM \"nfl_database\".\"main\".\"nfl_pbp_2024\"\n    WHERE play_type = 'pass'\n    AND receiver_position IN ('RB', 'WR', 'TE')\n    GROUP BY posteam, receiver_display_name, receiver_position\n)\nSELECT\n    COALESCE(rushing_stats.Team, receiving_stats.Team) AS Team,\n    COALESCE(rushing_stats.Player_Name, receiving_stats.Player_Name) AS Player_Name,\n    COALESCE(rushing_stats.Position, receiving_stats.Position) AS Position,\n    \n    COALESCE(Total_Rush_Attempts, 0) AS Total_Rush_Attempts,\n    COALESCE(Total_Rushing_Yards, 0) AS Total_Rushing_Yards,\n    \n    COALESCE(Total_Pass_Targets, 0) AS Total_Pass_Targets,\n    COALESCE(Total_Catches, 0) AS Total_Catches,\n    COALESCE(Total_Receiving_Yards, 0) AS Total_Receiving_Yards,\n    \n    ROUND(COALESCE(Total_Rushing_Yards, 0) + COALESCE(Total_Receiving_Yards, 0), 2) AS Total_Yards,\n    \n    COALESCE(Total_First_Downs_Rush, 0) AS Total_First_Downs_Rush,\n    COALESCE(Total_First_Downs_Pass, 0) AS Total_First_Downs_Pass,\n    \n    COALESCE(Third_Down_Conversions_Rush, 0) AS Third_Down_Conversions_Rush,\n    COALESCE(Third_Down_Conversions_Pass, 0) AS Third_Down_Conversions_Pass,\n    ROUND((COALESCE(Third_Down_Conversions_Rush, 0) + COALESCE(Third_Down_Conversions_Pass, 0)), 2) AS Total_Third_Down_Conversions,\n\n    COALESCE(Fourth_Down_Conversions_Rush, 0) AS Fourth_Down_Conversions_Rush,\n    COALESCE(Fourth_Down_Conversions_Pass, 0) AS Fourth_Down_Conversions_Pass,\n    ROUND((COALESCE(Fourth_Down_Conversions_Rush, 0) + COALESCE(Fourth_Down_Conversions_Pass, 0)), 2) AS Total_Fourth_Down_Conversions,\n    \n    -- Conversion and success rate calculations\n    ROUND(COALESCE(Total_First_Downs_Rush, 0) * 1.0 / COALESCE(NULLIF(Total_Rush_Attempts, 0), 1), 2) AS First_Down_Rush_Rate,\n    ROUND(COALESCE(Total_First_Downs_Pass, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS First_Down_Pass_Rate,\n    ROUND(COALESCE(Total_Catches, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS Catch_Rate,\n    \n    ROUND(COALESCE(Total_Rushing_Yards, 0) * 1.0 / COALESCE(NULLIF(Total_Rush_Attempts, 0), 1), 2) AS Average_Rushing_Yards_Per_Attempt,\n    ROUND(COALESCE(Total_Receiving_Yards, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS Average_Receiving_Yards_Per_Target,\n    \n    ROUND((COALESCE(Total_Rushing_EPA, 0) + COALESCE(Total_Receiving_EPA, 0)), 2) AS Total_EPA  -- Moved EPA to the last column\nFROM rushing_stats\nFULL OUTER JOIN receiving_stats\nON rushing_stats.Player_Name = receiving_stats.Player_Name\nAND rushing_stats.Team = receiving_stats.Team\nORDER BY Total_EPA DESC\n    );\n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On model.nfl.flex_stats: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"default\", \"target_name\": \"dev\", \"node_id\": \"model.nfl.flex_stats\"} */\n\n  \n    \n    \n\n    create  table\n      \"nfl_database\".\"main\".\"flex_stats__dbt_tmp\"\n  \n    as (\n      WITH rushing_stats AS (\n    SELECT\n        posteam AS Team,\n        rusher_player_name AS Player_Name,\n        rusher_position AS Position,\n        \n        COUNT(*) AS Total_Rush_Attempts,\n        ROUND(SUM(yards_gained), 2) AS Total_Rushing_Yards,\n        ROUND(SUM(CASE WHEN yards_gained >= 10 THEN 1 ELSE 0 END), 2) AS Explosive_Rushes,\n        ROUND(SUM(CASE WHEN first_down_rush = 1 THEN 1 ELSE 0 END), 2) AS Total_First_Downs_Rush,\n        ROUND(SUM(CASE WHEN touchdown = 1 THEN 1 ELSE 0 END), 2) AS Rushing_Touchdowns,\n        ROUND(SUM(CASE WHEN third_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Third_Down_Conversions_Rush,\n        ROUND(SUM(CASE WHEN fourth_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Fourth_Down_Conversions_Rush,\n        ROUND(SUM(epa), 2) AS Total_Rushing_EPA\n    FROM pbp\n    WHERE play_type = 'run'\n    AND rusher_position IN ('RB', 'WR', 'TE')\n    GROUP BY posteam, rusher_player_name, rusher_position\n),\nreceiving_stats AS (\n    SELECT\n        posteam AS Team,\n        receiver_display_name AS Player_Name,\n        receiver_position AS Position,\n        \n        COUNT(*) AS Total_Pass_Targets,\n        ROUND(SUM(CASE WHEN complete_pass = 1 THEN 1 ELSE 0 END), 2) AS Total_Catches,\n        ROUND(SUM(yards_gained), 2) AS Total_Receiving_Yards,\n        ROUND(SUM(air_yards), 2) AS Total_Air_Yards,\n        ROUND(SUM(yards_after_catch), 2) AS Total_YAC,\n        ROUND(SUM(CASE WHEN first_down_pass = 1 THEN 1 ELSE 0 END), 2) AS Total_First_Downs_Pass,\n        ROUND(SUM(CASE WHEN touchdown = 1 THEN 1 ELSE 0 END), 2) AS Receiving_Touchdowns,\n        ROUND(SUM(CASE WHEN third_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Third_Down_Conversions_Pass,\n        ROUND(SUM(CASE WHEN fourth_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Fourth_Down_Conversions_Pass,\n        ROUND(SUM(epa), 2) AS Total_Receiving_EPA\n    FROM \"nfl_database\".\"main\".\"nfl_pbp_2024\"\n    WHERE play_type = 'pass'\n    AND receiver_position IN ('RB', 'WR', 'TE')\n    GROUP BY posteam, receiver_display_name, receiver_position\n)\nSELECT\n    COALESCE(rushing_stats.Team, receiving_stats.Team) AS Team,\n    COALESCE(rushing_stats.Player_Name, receiving_stats.Player_Name) AS Player_Name,\n    COALESCE(rushing_stats.Position, receiving_stats.Position) AS Position,\n    \n    COALESCE(Total_Rush_Attempts, 0) AS Total_Rush_Attempts,\n    COALESCE(Total_Rushing_Yards, 0) AS Total_Rushing_Yards,\n    \n    COALESCE(Total_Pass_Targets, 0) AS Total_Pass_Targets,\n    COALESCE(Total_Catches, 0) AS Total_Catches,\n    COALESCE(Total_Receiving_Yards, 0) AS Total_Receiving_Yards,\n    \n    ROUND(COALESCE(Total_Rushing_Yards, 0) + COALESCE(Total_Receiving_Yards, 0), 2) AS Total_Yards,\n    \n    COALESCE(Total_First_Downs_Rush, 0) AS Total_First_Downs_Rush,\n    COALESCE(Total_First_Downs_Pass, 0) AS Total_First_Downs_Pass,\n    \n    COALESCE(Third_Down_Conversions_Rush, 0) AS Third_Down_Conversions_Rush,\n    COALESCE(Third_Down_Conversions_Pass, 0) AS Third_Down_Conversions_Pass,\n    ROUND((COALESCE(Third_Down_Conversions_Rush, 0) + COALESCE(Third_Down_Conversions_Pass, 0)), 2) AS Total_Third_Down_Conversions,\n\n    COALESCE(Fourth_Down_Conversions_Rush, 0) AS Fourth_Down_Conversions_Rush,\n    COALESCE(Fourth_Down_Conversions_Pass, 0) AS Fourth_Down_Conversions_Pass,\n    ROUND((COALESCE(Fourth_Down_Conversions_Rush, 0) + COALESCE(Fourth_Down_Conversions_Pass, 0)), 2) AS Total_Fourth_Down_Conversions,\n    \n    -- Conversion and success rate calculations\n    ROUND(COALESCE(Total_First_Downs_Rush, 0) * 1.0 / COALESCE(NULLIF(Total_Rush_Attempts, 0), 1), 2) AS First_Down_Rush_Rate,\n    ROUND(COALESCE(Total_First_Downs_Pass, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS First_Down_Pass_Rate,\n    ROUND(COALESCE(Total_Catches, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS Catch_Rate,\n    \n    ROUND(COALESCE(Total_Rushing_Yards, 0) * 1.0 / COALESCE(NULLIF(Total_Rush_Attempts, 0), 1), 2) AS Average_Rushing_Yards_Per_Attempt,\n    ROUND(COALESCE(Total_Receiving_Yards, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS Average_Receiving_Yards_Per_Target,\n    \n    ROUND((COALESCE(Total_Rushing_EPA, 0) + COALESCE(Total_Receiving_EPA, 0)), 2) AS Total_EPA  -- Moved EPA to the last column\nFROM rushing_stats\nFULL OUTER JOIN receiving_stats\nON rushing_stats.Player_Name = receiving_stats.Player_Name\nAND rushing_stats.Team = receiving_stats.Team\nORDER BY Total_EPA DESC\n    );\n  \n  ", "name": "SQLQuery", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.649587Z"}}
{"data": {"args": [], "base_msg": "Error running SQL: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"default\", \"target_name\": \"dev\", \"node_id\": \"model.nfl.flex_stats\"} */\n\n  \n    \n    \n\n    create  table\n      \"nfl_database\".\"main\".\"flex_stats__dbt_tmp\"\n  \n    as (\n      WITH rushing_stats AS (\n    SELECT\n        posteam AS Team,\n        rusher_player_name AS Player_Name,\n        rusher_position AS Position,\n        \n        COUNT(*) AS Total_Rush_Attempts,\n        ROUND(SUM(yards_gained), 2) AS Total_Rushing_Yards,\n        ROUND(SUM(CASE WHEN yards_gained >= 10 THEN 1 ELSE 0 END), 2) AS Explosive_Rushes,\n        ROUND(SUM(CASE WHEN first_down_rush = 1 THEN 1 ELSE 0 END), 2) AS Total_First_Downs_Rush,\n        ROUND(SUM(CASE WHEN touchdown = 1 THEN 1 ELSE 0 END), 2) AS Rushing_Touchdowns,\n        ROUND(SUM(CASE WHEN third_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Third_Down_Conversions_Rush,\n        ROUND(SUM(CASE WHEN fourth_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Fourth_Down_Conversions_Rush,\n        ROUND(SUM(epa), 2) AS Total_Rushing_EPA\n    FROM pbp\n    WHERE play_type = 'run'\n    AND rusher_position IN ('RB', 'WR', 'TE')\n    GROUP BY posteam, rusher_player_name, rusher_position\n),\nreceiving_stats AS (\n    SELECT\n        posteam AS Team,\n        receiver_display_name AS Player_Name,\n        receiver_position AS Position,\n        \n        COUNT(*) AS Total_Pass_Targets,\n        ROUND(SUM(CASE WHEN complete_pass = 1 THEN 1 ELSE 0 END), 2) AS Total_Catches,\n        ROUND(SUM(yards_gained), 2) AS Total_Receiving_Yards,\n        ROUND(SUM(air_yards), 2) AS Total_Air_Yards,\n        ROUND(SUM(yards_after_catch), 2) AS Total_YAC,\n        ROUND(SUM(CASE WHEN first_down_pass = 1 THEN 1 ELSE 0 END), 2) AS Total_First_Downs_Pass,\n        ROUND(SUM(CASE WHEN touchdown = 1 THEN 1 ELSE 0 END), 2) AS Receiving_Touchdowns,\n        ROUND(SUM(CASE WHEN third_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Third_Down_Conversions_Pass,\n        ROUND(SUM(CASE WHEN fourth_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Fourth_Down_Conversions_Pass,\n        ROUND(SUM(epa), 2) AS Total_Receiving_EPA\n    FROM \"nfl_database\".\"main\".\"nfl_pbp_2024\"\n    WHERE play_type = 'pass'\n    AND receiver_position IN ('RB', 'WR', 'TE')\n    GROUP BY posteam, receiver_display_name, receiver_position\n)\nSELECT\n    COALESCE(rushing_stats.Team, receiving_stats.Team) AS Team,\n    COALESCE(rushing_stats.Player_Name, receiving_stats.Player_Name) AS Player_Name,\n    COALESCE(rushing_stats.Position, receiving_stats.Position) AS Position,\n    \n    COALESCE(Total_Rush_Attempts, 0) AS Total_Rush_Attempts,\n    COALESCE(Total_Rushing_Yards, 0) AS Total_Rushing_Yards,\n    \n    COALESCE(Total_Pass_Targets, 0) AS Total_Pass_Targets,\n    COALESCE(Total_Catches, 0) AS Total_Catches,\n    COALESCE(Total_Receiving_Yards, 0) AS Total_Receiving_Yards,\n    \n    ROUND(COALESCE(Total_Rushing_Yards, 0) + COALESCE(Total_Receiving_Yards, 0), 2) AS Total_Yards,\n    \n    COALESCE(Total_First_Downs_Rush, 0) AS Total_First_Downs_Rush,\n    COALESCE(Total_First_Downs_Pass, 0) AS Total_First_Downs_Pass,\n    \n    COALESCE(Third_Down_Conversions_Rush, 0) AS Third_Down_Conversions_Rush,\n    COALESCE(Third_Down_Conversions_Pass, 0) AS Third_Down_Conversions_Pass,\n    ROUND((COALESCE(Third_Down_Conversions_Rush, 0) + COALESCE(Third_Down_Conversions_Pass, 0)), 2) AS Total_Third_Down_Conversions,\n\n    COALESCE(Fourth_Down_Conversions_Rush, 0) AS Fourth_Down_Conversions_Rush,\n    COALESCE(Fourth_Down_Conversions_Pass, 0) AS Fourth_Down_Conversions_Pass,\n    ROUND((COALESCE(Fourth_Down_Conversions_Rush, 0) + COALESCE(Fourth_Down_Conversions_Pass, 0)), 2) AS Total_Fourth_Down_Conversions,\n    \n    -- Conversion and success rate calculations\n    ROUND(COALESCE(Total_First_Downs_Rush, 0) * 1.0 / COALESCE(NULLIF(Total_Rush_Attempts, 0), 1), 2) AS First_Down_Rush_Rate,\n    ROUND(COALESCE(Total_First_Downs_Pass, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS First_Down_Pass_Rate,\n    ROUND(COALESCE(Total_Catches, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS Catch_Rate,\n    \n    ROUND(COALESCE(Total_Rushing_Yards, 0) * 1.0 / COALESCE(NULLIF(Total_Rush_Attempts, 0), 1), 2) AS Average_Rushing_Yards_Per_Attempt,\n    ROUND(COALESCE(Total_Receiving_Yards, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS Average_Receiving_Yards_Per_Target,\n    \n    ROUND((COALESCE(Total_Rushing_EPA, 0) + COALESCE(Total_Receiving_EPA, 0)), 2) AS Total_EPA  -- Moved EPA to the last column\nFROM rushing_stats\nFULL OUTER JOIN receiving_stats\nON rushing_stats.Player_Name = receiving_stats.Player_Name\nAND rushing_stats.Team = receiving_stats.Team\nORDER BY Total_EPA DESC\n    );\n  \n  ", "name": "DuckDB", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "DuckDB adapter: Error running SQL: /* {\"app\": \"dbt\", \"dbt_version\": \"1.8.7\", \"profile_name\": \"default\", \"target_name\": \"dev\", \"node_id\": \"model.nfl.flex_stats\"} */\n\n  \n    \n    \n\n    create  table\n      \"nfl_database\".\"main\".\"flex_stats__dbt_tmp\"\n  \n    as (\n      WITH rushing_stats AS (\n    SELECT\n        posteam AS Team,\n        rusher_player_name AS Player_Name,\n        rusher_position AS Position,\n        \n        COUNT(*) AS Total_Rush_Attempts,\n        ROUND(SUM(yards_gained), 2) AS Total_Rushing_Yards,\n        ROUND(SUM(CASE WHEN yards_gained >= 10 THEN 1 ELSE 0 END), 2) AS Explosive_Rushes,\n        ROUND(SUM(CASE WHEN first_down_rush = 1 THEN 1 ELSE 0 END), 2) AS Total_First_Downs_Rush,\n        ROUND(SUM(CASE WHEN touchdown = 1 THEN 1 ELSE 0 END), 2) AS Rushing_Touchdowns,\n        ROUND(SUM(CASE WHEN third_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Third_Down_Conversions_Rush,\n        ROUND(SUM(CASE WHEN fourth_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Fourth_Down_Conversions_Rush,\n        ROUND(SUM(epa), 2) AS Total_Rushing_EPA\n    FROM pbp\n    WHERE play_type = 'run'\n    AND rusher_position IN ('RB', 'WR', 'TE')\n    GROUP BY posteam, rusher_player_name, rusher_position\n),\nreceiving_stats AS (\n    SELECT\n        posteam AS Team,\n        receiver_display_name AS Player_Name,\n        receiver_position AS Position,\n        \n        COUNT(*) AS Total_Pass_Targets,\n        ROUND(SUM(CASE WHEN complete_pass = 1 THEN 1 ELSE 0 END), 2) AS Total_Catches,\n        ROUND(SUM(yards_gained), 2) AS Total_Receiving_Yards,\n        ROUND(SUM(air_yards), 2) AS Total_Air_Yards,\n        ROUND(SUM(yards_after_catch), 2) AS Total_YAC,\n        ROUND(SUM(CASE WHEN first_down_pass = 1 THEN 1 ELSE 0 END), 2) AS Total_First_Downs_Pass,\n        ROUND(SUM(CASE WHEN touchdown = 1 THEN 1 ELSE 0 END), 2) AS Receiving_Touchdowns,\n        ROUND(SUM(CASE WHEN third_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Third_Down_Conversions_Pass,\n        ROUND(SUM(CASE WHEN fourth_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Fourth_Down_Conversions_Pass,\n        ROUND(SUM(epa), 2) AS Total_Receiving_EPA\n    FROM \"nfl_database\".\"main\".\"nfl_pbp_2024\"\n    WHERE play_type = 'pass'\n    AND receiver_position IN ('RB', 'WR', 'TE')\n    GROUP BY posteam, receiver_display_name, receiver_position\n)\nSELECT\n    COALESCE(rushing_stats.Team, receiving_stats.Team) AS Team,\n    COALESCE(rushing_stats.Player_Name, receiving_stats.Player_Name) AS Player_Name,\n    COALESCE(rushing_stats.Position, receiving_stats.Position) AS Position,\n    \n    COALESCE(Total_Rush_Attempts, 0) AS Total_Rush_Attempts,\n    COALESCE(Total_Rushing_Yards, 0) AS Total_Rushing_Yards,\n    \n    COALESCE(Total_Pass_Targets, 0) AS Total_Pass_Targets,\n    COALESCE(Total_Catches, 0) AS Total_Catches,\n    COALESCE(Total_Receiving_Yards, 0) AS Total_Receiving_Yards,\n    \n    ROUND(COALESCE(Total_Rushing_Yards, 0) + COALESCE(Total_Receiving_Yards, 0), 2) AS Total_Yards,\n    \n    COALESCE(Total_First_Downs_Rush, 0) AS Total_First_Downs_Rush,\n    COALESCE(Total_First_Downs_Pass, 0) AS Total_First_Downs_Pass,\n    \n    COALESCE(Third_Down_Conversions_Rush, 0) AS Third_Down_Conversions_Rush,\n    COALESCE(Third_Down_Conversions_Pass, 0) AS Third_Down_Conversions_Pass,\n    ROUND((COALESCE(Third_Down_Conversions_Rush, 0) + COALESCE(Third_Down_Conversions_Pass, 0)), 2) AS Total_Third_Down_Conversions,\n\n    COALESCE(Fourth_Down_Conversions_Rush, 0) AS Fourth_Down_Conversions_Rush,\n    COALESCE(Fourth_Down_Conversions_Pass, 0) AS Fourth_Down_Conversions_Pass,\n    ROUND((COALESCE(Fourth_Down_Conversions_Rush, 0) + COALESCE(Fourth_Down_Conversions_Pass, 0)), 2) AS Total_Fourth_Down_Conversions,\n    \n    -- Conversion and success rate calculations\n    ROUND(COALESCE(Total_First_Downs_Rush, 0) * 1.0 / COALESCE(NULLIF(Total_Rush_Attempts, 0), 1), 2) AS First_Down_Rush_Rate,\n    ROUND(COALESCE(Total_First_Downs_Pass, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS First_Down_Pass_Rate,\n    ROUND(COALESCE(Total_Catches, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS Catch_Rate,\n    \n    ROUND(COALESCE(Total_Rushing_Yards, 0) * 1.0 / COALESCE(NULLIF(Total_Rush_Attempts, 0), 1), 2) AS Average_Rushing_Yards_Per_Attempt,\n    ROUND(COALESCE(Total_Receiving_Yards, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS Average_Receiving_Yards_Per_Target,\n    \n    ROUND((COALESCE(Total_Rushing_EPA, 0) + COALESCE(Total_Receiving_EPA, 0)), 2) AS Total_EPA  -- Moved EPA to the last column\nFROM rushing_stats\nFULL OUTER JOIN receiving_stats\nON rushing_stats.Player_Name = receiving_stats.Player_Name\nAND rushing_stats.Team = receiving_stats.Team\nORDER BY Total_EPA DESC\n    );\n  \n  ", "name": "AdapterEventDebug", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.670416Z"}}
{"data": {"args": [], "base_msg": "Rolling back transaction.", "name": "DuckDB", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "DuckDB adapter: Rolling back transaction.", "name": "AdapterEventDebug", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.671158Z"}}
{"data": {"conn_name": "model.nfl.flex_stats", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On model.nfl.flex_stats: ROLLBACK", "name": "Rollback", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.671703Z"}}
{"data": {"conn_name": "model.nfl.flex_stats", "exc_info": "Traceback (most recent call last):\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/duckdb/connections.py\", line 84, in exception_handler\n    yield\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/sql/connections.py\", line 93, in add_query\n    cursor.execute(sql, bindings)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/duckdb/environments/local.py\", line 23, in execute\n    return self._cursor.execute(sql)\nduckdb.duckdb.CatalogException: Catalog Error: Table with name pbp does not exist!\nDid you mean \"pg_am\"?\nLINE 25:     FROM pbp\n                  ^\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/base/impl.py\", line 352, in connection_named\n    yield\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/task/base.py\", line 314, in compile_and_execute\n    result = self.run(ctx.node, manifest)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/task/base.py\", line 415, in run\n    return self.execute(compiled_node, manifest)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/task/run.py\", line 298, in execute\n    result = MacroGenerator(\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/clients/jinja.py\", line 84, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt_common/clients/jinja.py\", line 322, in call_macro\n    return macro(*args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/runtime.py\", line 768, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/runtime.py\", line 782, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 83, in macro\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/sandbox.py\", line 394, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/clients/jinja.py\", line 84, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt_common/clients/jinja.py\", line 322, in call_macro\n    return macro(*args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/runtime.py\", line 768, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/runtime.py\", line 782, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 52, in macro\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/sandbox.py\", line 394, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/base/impl.py\", line 379, in execute\n    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/duckdb/connections.py\", line 119, in execute\n    return super().execute(sql, auto_begin, fetch, limit)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/sql/connections.py\", line 154, in execute\n    _, cursor = self.add_query(sql, auto_begin)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/sql/connections.py\", line 76, in add_query\n    with self.exception_handler(sql):\n  File \"/usr/lib/python3.10/contextlib.py\", line 153, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/duckdb/connections.py\", line 92, in exception_handler\n    raise dbt.exceptions.DbtRuntimeError(str(exc)) from exc\ndbt_common.exceptions.base.DbtRuntimeError: Runtime Error\n  Catalog Error: Table with name pbp does not exist!\n  Did you mean \"pg_am\"?\n  LINE 25:     FROM pbp\n                    ^\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/base/connections.py\", line 328, in _rollback_handle\n    connection.handle.rollback()\nAttributeError: 'DuckDBConnectionWrapper' object has no attribute 'rollback'\n", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "E009", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Failed to rollback 'model.nfl.flex_stats'", "name": "RollbackFailed", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.673388Z"}}
{"data": {"conn_name": "model.nfl.flex_stats", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On model.nfl.flex_stats: Close", "name": "ConnectionClosed", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.673842Z"}}
{"data": {"exc": "Runtime Error in model flex_stats (models/flex_stats.sql)\n  Catalog Error: Table with name pbp does not exist!\n  Did you mean \"pg_am\"?\n  LINE 25:     FROM pbp\n                    ^", "exc_info": "Traceback (most recent call last):\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/duckdb/connections.py\", line 84, in exception_handler\n    yield\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/sql/connections.py\", line 93, in add_query\n    cursor.execute(sql, bindings)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/duckdb/environments/local.py\", line 23, in execute\n    return self._cursor.execute(sql)\nduckdb.duckdb.CatalogException: Catalog Error: Table with name pbp does not exist!\nDid you mean \"pg_am\"?\nLINE 25:     FROM pbp\n                  ^\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/task/base.py\", line 368, in safe_run\n    result = self.compile_and_execute(manifest, ctx)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/task/base.py\", line 314, in compile_and_execute\n    result = self.run(ctx.node, manifest)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/task/base.py\", line 415, in run\n    return self.execute(compiled_node, manifest)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/task/run.py\", line 298, in execute\n    result = MacroGenerator(\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/clients/jinja.py\", line 84, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt_common/clients/jinja.py\", line 322, in call_macro\n    return macro(*args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/runtime.py\", line 768, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/runtime.py\", line 782, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 83, in macro\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/sandbox.py\", line 394, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/clients/jinja.py\", line 84, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt_common/clients/jinja.py\", line 322, in call_macro\n    return macro(*args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/runtime.py\", line 768, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/runtime.py\", line 782, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 52, in macro\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/sandbox.py\", line 394, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/base/impl.py\", line 379, in execute\n    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/duckdb/connections.py\", line 119, in execute\n    return super().execute(sql, auto_begin, fetch, limit)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/sql/connections.py\", line 154, in execute\n    _, cursor = self.add_query(sql, auto_begin)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/sql/connections.py\", line 76, in add_query\n    with self.exception_handler(sql):\n  File \"/usr/lib/python3.10/contextlib.py\", line 153, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/home/christianocean/mta/.venv/lib/python3.10/site-packages/dbt/adapters/duckdb/connections.py\", line 92, in exception_handler\n    raise dbt.exceptions.DbtRuntimeError(str(exc)) from exc\ndbt_common.exceptions.base.DbtRuntimeError: Runtime Error in model flex_stats (models/flex_stats.sql)\n  Catalog Error: Table with name pbp does not exist!\n  Did you mean \"pg_am\"?\n  LINE 25:     FROM pbp\n                    ^\n", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "executing", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "W002", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Runtime Error in model flex_stats (models/flex_stats.sql)\n  Catalog Error: Table with name pbp does not exist!\n  Did you mean \"pg_am\"?\n  LINE 25:     FROM pbp\n                    ^", "name": "CatchableExceptionOnRun", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.677150Z"}}
{"data": {"description": "sql table model main.flex_stats", "execution_time": 0.12260437, "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-01T15:16:59.677614", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "error", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}, "status": "error", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "error", "msg": "1 of 1 ERROR creating sql table model main.flex_stats .......................... [\u001b[31mERROR\u001b[0m in 0.12s]", "name": "LogModelResult", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.678646Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-10-01T15:16:59.677614", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "2024-10-01T15:16:59.553645", "node_status": "error", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}, "run_result": {"adapter_response": {}, "execution_time": 0.12260437, "message": "Runtime Error in model flex_stats (models/flex_stats.sql)\n  Catalog Error: Table with name pbp does not exist!\n  Did you mean \"pg_am\"?\n  LINE 25:     FROM pbp\n                    ^", "num_failures": 0, "status": "error", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-01T15:16:59.566219Z", "name": "compile", "started_at": "2024-10-01T15:16:59.556116Z"}, {"completed_at": "2024-10-01T15:16:59.671605Z", "name": "execute", "started_at": "2024-10-01T15:16:59.566996Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Finished running node model.nfl.flex_stats", "name": "NodeFinished", "pid": 2079383, "thread": "Thread-1 (worker)", "ts": "2024-10-01T15:16:59.679423Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Using duckdb connection \"master\"", "name": "ConnectionUsed", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.682721Z"}}
{"data": {"conn_name": "master", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On master: BEGIN", "name": "SQLQuery", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.683135Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.683466Z"}}
{"data": {"elapsed": 0.008100171, "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "SQL status: OK in 0.008 seconds", "name": "SQLQueryStatus", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.691685Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.692413Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Using duckdb connection \"master\"", "name": "ConnectionUsed", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.693127Z"}}
{"data": {"conn_name": "master", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On master: COMMIT", "name": "SQLQuery", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.693505Z"}}
{"data": {"elapsed": 0.00030858198, "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.694220Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.694647Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.697549Z"}}
{"data": {"conn_name": "list_nfl_database_main"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Connection 'list_nfl_database_main' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.698022Z"}}
{"data": {"conn_name": "model.nfl.flex_stats"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Connection 'model.nfl.flex_stats' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.698407Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "", "name": "Formatting", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.698900Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 0.28 seconds", "execution_time": 0.28154135, "stat_line": "1 table model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).", "name": "FinishedRunningStats", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.699558Z"}}
{"data": {"elapsed_time": 0.28154135, "generated_at": "2024-10-01T15:16:59Z", "results": [{"adapter_response": {}, "execution_time": 0.12260437, "message": "Runtime Error in model flex_stats (models/flex_stats.sql)\n  Catalog Error: Table with name pbp does not exist!\n  Did you mean \"pg_am\"?\n  LINE 25:     FROM pbp\n                    ^", "num_failures": 0, "status": "error", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-10-01T15:16:59.566219Z", "name": "compile", "started_at": "2024-10-01T15:16:59.556116Z"}, {"completed_at": "2024-10-01T15:16:59.671605Z", "name": "execute", "started_at": "2024-10-01T15:16:59.566996Z"}]}], "success": false}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.700249Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "", "name": "Formatting", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.724352Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 1, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "\u001b[31mCompleted with 1 error and 0 warnings:\u001b[0m", "name": "EndOfRunSummary", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.725256Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "", "name": "Formatting", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.725678Z"}}
{"data": {"msg": "Runtime Error in model flex_stats (models/flex_stats.sql)\n  Catalog Error: Table with name pbp does not exist!\n  Did you mean \"pg_am\"?\n  LINE 25:     FROM pbp\n                    ^", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "flex_stats", "node_path": "flex_stats.sql", "node_relation": {"alias": "flex_stats", "database": "nfl_database", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\"", "schema": "main"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nfl.flex_stats"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "error", "msg": "  Runtime Error in model flex_stats (models/flex_stats.sql)\n  Catalog Error: Table with name pbp does not exist!\n  Did you mean \"pg_am\"?\n  LINE 25:     FROM pbp\n                    ^", "name": "RunResultError", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.726109Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "", "name": "Formatting", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.726520Z"}}
{"data": {"stats": {"error": 1, "pass": 0, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "info", "msg": "Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.726873Z"}}
{"data": {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8070781, "process_in_blocks": "2176", "process_kernel_time": 0.111386, "process_mem_max_rss": "301264", "process_out_blocks": "2008", "process_user_time": 1.549285}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Resource report: {\"command_name\": \"build\", \"command_wall_clock_time\": 0.8070781, \"process_user_time\": 1.549285, \"process_kernel_time\": 0.111386, \"process_mem_max_rss\": \"301264\", \"process_in_blocks\": \"2176\", \"process_out_blocks\": \"2008\", \"command_success\": false}", "name": "ResourceReport", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.727647Z"}}
{"data": {"command": "dbt build", "completed_at": "2024-10-01T15:16:59.728171Z", "elapsed": 0.8077315, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Command `dbt build` failed at 11:16:59.728171 after 0.81 seconds", "name": "CommandCompleted", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.728261Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 2079383, "thread": "MainThread", "ts": "2024-10-01T15:16:59.728731Z"}}
