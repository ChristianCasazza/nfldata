{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2024-10-01T15:16:59.699951Z", "invocation_id": "e23d1e59-ff56-415e-86d9-0591db6ac890", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2024-10-01T15:16:59.556116Z", "completed_at": "2024-10-01T15:16:59.566219Z"}, {"name": "execute", "started_at": "2024-10-01T15:16:59.566996Z", "completed_at": "2024-10-01T15:16:59.671605Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1226043701171875, "adapter_response": {}, "message": "Runtime Error in model flex_stats (models/flex_stats.sql)\n  Catalog Error: Table with name pbp does not exist!\n  Did you mean \"pg_am\"?\n  LINE 25:     FROM pbp\n                    ^", "failures": null, "unique_id": "model.nfl.flex_stats", "compiled": true, "compiled_code": "WITH rushing_stats AS (\n    SELECT\n        posteam AS Team,\n        rusher_player_name AS Player_Name,\n        rusher_position AS Position,\n        \n        COUNT(*) AS Total_Rush_Attempts,\n        ROUND(SUM(yards_gained), 2) AS Total_Rushing_Yards,\n        ROUND(SUM(CASE WHEN yards_gained >= 10 THEN 1 ELSE 0 END), 2) AS Explosive_Rushes,\n        ROUND(SUM(CASE WHEN first_down_rush = 1 THEN 1 ELSE 0 END), 2) AS Total_First_Downs_Rush,\n        ROUND(SUM(CASE WHEN touchdown = 1 THEN 1 ELSE 0 END), 2) AS Rushing_Touchdowns,\n        ROUND(SUM(CASE WHEN third_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Third_Down_Conversions_Rush,\n        ROUND(SUM(CASE WHEN fourth_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Fourth_Down_Conversions_Rush,\n        ROUND(SUM(epa), 2) AS Total_Rushing_EPA\n    FROM pbp\n    WHERE play_type = 'run'\n    AND rusher_position IN ('RB', 'WR', 'TE')\n    GROUP BY posteam, rusher_player_name, rusher_position\n),\nreceiving_stats AS (\n    SELECT\n        posteam AS Team,\n        receiver_display_name AS Player_Name,\n        receiver_position AS Position,\n        \n        COUNT(*) AS Total_Pass_Targets,\n        ROUND(SUM(CASE WHEN complete_pass = 1 THEN 1 ELSE 0 END), 2) AS Total_Catches,\n        ROUND(SUM(yards_gained), 2) AS Total_Receiving_Yards,\n        ROUND(SUM(air_yards), 2) AS Total_Air_Yards,\n        ROUND(SUM(yards_after_catch), 2) AS Total_YAC,\n        ROUND(SUM(CASE WHEN first_down_pass = 1 THEN 1 ELSE 0 END), 2) AS Total_First_Downs_Pass,\n        ROUND(SUM(CASE WHEN touchdown = 1 THEN 1 ELSE 0 END), 2) AS Receiving_Touchdowns,\n        ROUND(SUM(CASE WHEN third_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Third_Down_Conversions_Pass,\n        ROUND(SUM(CASE WHEN fourth_down_converted = 1 THEN 1 ELSE 0 END), 2) AS Fourth_Down_Conversions_Pass,\n        ROUND(SUM(epa), 2) AS Total_Receiving_EPA\n    FROM \"nfl_database\".\"main\".\"nfl_pbp_2024\"\n    WHERE play_type = 'pass'\n    AND receiver_position IN ('RB', 'WR', 'TE')\n    GROUP BY posteam, receiver_display_name, receiver_position\n)\nSELECT\n    COALESCE(rushing_stats.Team, receiving_stats.Team) AS Team,\n    COALESCE(rushing_stats.Player_Name, receiving_stats.Player_Name) AS Player_Name,\n    COALESCE(rushing_stats.Position, receiving_stats.Position) AS Position,\n    \n    COALESCE(Total_Rush_Attempts, 0) AS Total_Rush_Attempts,\n    COALESCE(Total_Rushing_Yards, 0) AS Total_Rushing_Yards,\n    \n    COALESCE(Total_Pass_Targets, 0) AS Total_Pass_Targets,\n    COALESCE(Total_Catches, 0) AS Total_Catches,\n    COALESCE(Total_Receiving_Yards, 0) AS Total_Receiving_Yards,\n    \n    ROUND(COALESCE(Total_Rushing_Yards, 0) + COALESCE(Total_Receiving_Yards, 0), 2) AS Total_Yards,\n    \n    COALESCE(Total_First_Downs_Rush, 0) AS Total_First_Downs_Rush,\n    COALESCE(Total_First_Downs_Pass, 0) AS Total_First_Downs_Pass,\n    \n    COALESCE(Third_Down_Conversions_Rush, 0) AS Third_Down_Conversions_Rush,\n    COALESCE(Third_Down_Conversions_Pass, 0) AS Third_Down_Conversions_Pass,\n    ROUND((COALESCE(Third_Down_Conversions_Rush, 0) + COALESCE(Third_Down_Conversions_Pass, 0)), 2) AS Total_Third_Down_Conversions,\n\n    COALESCE(Fourth_Down_Conversions_Rush, 0) AS Fourth_Down_Conversions_Rush,\n    COALESCE(Fourth_Down_Conversions_Pass, 0) AS Fourth_Down_Conversions_Pass,\n    ROUND((COALESCE(Fourth_Down_Conversions_Rush, 0) + COALESCE(Fourth_Down_Conversions_Pass, 0)), 2) AS Total_Fourth_Down_Conversions,\n    \n    -- Conversion and success rate calculations\n    ROUND(COALESCE(Total_First_Downs_Rush, 0) * 1.0 / COALESCE(NULLIF(Total_Rush_Attempts, 0), 1), 2) AS First_Down_Rush_Rate,\n    ROUND(COALESCE(Total_First_Downs_Pass, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS First_Down_Pass_Rate,\n    ROUND(COALESCE(Total_Catches, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS Catch_Rate,\n    \n    ROUND(COALESCE(Total_Rushing_Yards, 0) * 1.0 / COALESCE(NULLIF(Total_Rush_Attempts, 0), 1), 2) AS Average_Rushing_Yards_Per_Attempt,\n    ROUND(COALESCE(Total_Receiving_Yards, 0) * 1.0 / COALESCE(NULLIF(Total_Pass_Targets, 0), 1), 2) AS Average_Receiving_Yards_Per_Target,\n    \n    ROUND((COALESCE(Total_Rushing_EPA, 0) + COALESCE(Total_Receiving_EPA, 0)), 2) AS Total_EPA  -- Moved EPA to the last column\nFROM rushing_stats\nFULL OUTER JOIN receiving_stats\nON rushing_stats.Player_Name = receiving_stats.Player_Name\nAND rushing_stats.Team = receiving_stats.Team\nORDER BY Total_EPA DESC", "relation_name": "\"nfl_database\".\"main\".\"flex_stats\""}], "elapsed_time": 0.2815413475036621, "args": {"indirect_selection": "eager", "use_colors": true, "require_resource_names_without_spaces": false, "warn_error_options": {"include": [], "exclude": []}, "log_format": "json", "partial_parse": true, "export_saved_queries": false, "select": ["nfl.flex_stats"], "empty": false, "defer": false, "enable_legacy_logger": false, "project_dir": "/home/christianocean/mta/nfl/transformations/dbt", "quiet": false, "which": "build", "partial_parse_file_diff": true, "log_file_max_bytes": 10485760, "log_level_file": "debug", "introspect": true, "require_explicit_package_overrides_for_builtin_materializations": true, "populate_cache": true, "include_saved_query": false, "resource_types": [], "profiles_dir": "/home/christianocean/mta/nfl/transformations/dbt", "version_check": true, "write_json": true, "invocation_command": "dbt build --select nfl.flex_stats", "macro_debugging": false, "static_parser": true, "favor_state": false, "target_path": "target/dbt_project_assets-7064c91-a988bc2", "exclude": [], "use_colors_file": true, "exclude_resource_types": [], "printer_width": 80, "send_anonymous_usage_stats": false, "strict_mode": false, "cache_selected_only": false, "log_format_file": "json", "show_resource_report": false, "log_path": "/home/christianocean/mta/nfl/transformations/dbt/target/dbt_project_assets-7064c91-a988bc2", "source_freshness_run_project_hooks": false, "show": false, "vars": {}, "log_level": "info", "print": true}}